<article class="article-template py-12">
  {% for block in section.blocks %}
    {% case block.type %}
      {% when 'article_title' %}
        <div class="flex item-center justify-center text-center flex-col">
          <a href="{{ blog.url }}" class="text.uppercase.text text-gray-500 hover:text-grey-900 font-bold">
            {{- blog.title -}}
          </a>

          <h1 class="text-4xl md:text-6xl font-medium">{{ article.title }}</h1>
        </div>

      {% when 'article_author' %}
        {% if section.settings.show_author %}
          <div class="flex item-center justify-center text-center flex-col mt-2 mb-4">
            <small> {{ article.author }} </small><br>
          </div>
        {% endif %}

      {% when 'article_date' %}
        {% if section.settings.show_date %}
          <div class="flex item-center justify-center text-center flex-col mt-2 mb-4">
            <time datetime="{{ article.published_at | date: "%Y-%m-%d" }}">
              {{ article.published_at | date: format: 'on_date' }}
            </time>
          </div>
        {% endif %}

      {% when 'article_image' %}
        {% if section.settings.show_image %}
          <div class="flex item-center justify-center text-center mt-2 mb-4 max-w-7xl">
            {% if article.image != blank %}
              <img
                src="{{ article.image | image_url: width: 800 }}"
                alt="{{ article.image.alt | escape }}"
                width="800"
                height="auto"
              >
            {% else %}
              {% assign placeholder_image = 'lifestyle-1' %}
              {{ placeholder_image | placeholder_svg_tag: 'w-full h-80 md:h-96 object-cover object-center p-5' }}
            {% endif %}
          </div>
        {% endif %}

      {% when 'article_content' %}
        <div class="flex item-center justify-center">
          <div class="max-w-4xl">{{ article.content }}</div>
        </div>
    {% endcase %}
  {% endfor %}
</article>

{% if blog.comments_enabled? %}
  <div id="comments" class="my-8">
    {% if article.comments_count > 0 %}
      <div class="flex items-center justify-center text-center flex-col">
        <h2 class="text-2xl font-medium mb-4">See what people are saying</h2>

        {% paginate article.comments by 5 %}
          {% for comment in article.comments %}
            <div class="flex-1 border my-4 px-4 py-2 sm:px-6 leading-relaxed text-left w-full max-w-xl">
              <div class="mb-1">
                <span class="font-semibold">{{ comment.author }}</span>
                <span class="text-xs text-gray-500 ml-2">
                  {{ comment.created_at | date: format: 'default' }}
                </span>
              </div>
              <p class="text-sm">{{ comment.content }}</p>
            </div>
          {% endfor %}

          {% if paginate.pages > 1 %}
            <div class="mt-4">
              {{ paginate | default_pagination: previous: 'Previous', next: 'Next' }}
            </div>
          {% endif %}
        {% endpaginate %}
      </div>
    {% else %}
      <h2 class="text-2xl font-medium mb-4 text-center">No Comments In this article !</h2>
    {% endif %}
  </div>

  <div id="comment-form" class="my-8">
    {% form 'new_comment', article %}
      {% if form.errors %}
        <div class="border p-5">
          <div class="flex flex-row items-center w-full my-3">
            <div class="text-red-500">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm-1-4a1 1 0 112 0 1 1 0 01-2 0zm.293-7.707a1 1 0 011.414 0l.293.293V11a1 1 0 11-2 0V6.586l.293-.293z" clip-rule="evenodd"/>
              </svg>
            </div>
            <div class="error text-sm ml-2">Oops! Your comment was not posted.</div>
          </div>

          <ul class="list-disc list-inside text-sm text-red-500 mt-2">
            {% for field in form.errors %}
              {% for message in form.errors.messages[field] %}
                <li>{{ message }}</li>
              {% endfor %}
            {% endfor %}
          </ul>
        </div>
      {% elsif form.posted_successfully? %}
        <div class="flex flex-row items-center w-full my-3 py-4 border p-4 rounded bg-green-50">
          <div class="text-green-600 font-medium">
            âœ… Your comment has been posted successfully!
          </div>
        </div>
      {% endif %}

      <div class="flex-1 mx-auto items-center justify-center max-w-4xl px-4">
        <div class="px-1 md:flex mb-3">
          <div class="px-3 md:w-1/2">
            <label for="comment_author" class="mt-[10px] mb-[10px] mx-0 block text-sm font-medium text-gray-700">Name</label>
            <input
              type="text"
              name="comment[author]"
              id="comment_author"
              required
              class="rounded-[10px] w-full text-grey-700 border py-3 px-4 mb-3 focus:outline-none"
              placeholder="Your name">
          </div>
          <div class="px-3 md:w-1/2">
            <label for="comment_email" class="mt-[10px] mb-[10px] mx-0 block text-sm font-medium text-gray-700">Email</label>
            <input
              type="email"
              name="comment[email]"
              id="comment_email"
              required
              class="rounded-[10px] w-full text-grey-700 border py-3 px-4 mb-3 focus:outline-none"
              placeholder="Your email">
          </div>
        </div>

        <div class="px-1 md:flex mb-3">
          <div class="md:w-full px-3">
            <label for="comment_body" class="mt-[10px] mb-[10px] mx-0 block text-sm font-medium text-gray-700">Comment</label>
            <textarea
              name="comment[body]"
              id="comment_body"
              rows="4"
              required
              class="rounded-[10px] w-full text-grey-700 border py-3 px-4 mb-3 focus:outline-none"
              placeholder="Your comment"></textarea>
          </div>
        </div>

        <div class="px-1 md:flex mb-3">
          <div class="md:w-full px-3">
            <input
              type="submit"
              class="bg-gray-800 text-white py-3 px-6 rounded-[10px] hover:bg-gray-700 cursor-pointer"
              value="Post Comment">
          </div>
        </div>
      </div>
    {% endform %}
  </div>
{% endif %}

{% schema %}
{
  "name": "Article template",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_author",
      "default": true,
      "label": "Show author"
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "default": true,
      "label": "Show date"
    },
    {
      "type": "checkbox",
      "id": "show_image",
      "default": true,
      "label": "Show image"
    }
  ],
  "blocks": [
    { "type": "article_title", "name": "Title", "limit": 1 },
    { "type": "article_author", "name": "Author", "limit": 1 },
    { "type": "article_date", "name": "Date", "limit": 1 },
    { "type": "article_image", "name": "Image", "limit": 1 },
    { "type": "article_content", "name": "Content", "limit": 1 }
  ]
}
{% endschema %}
